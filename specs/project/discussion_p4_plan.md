# 議事録：LLM動的UI生成型思考整理アプリ - Planフェーズ設計

**日付**: 2025年10月22日  
**議題**: Planフェーズにおける動的UI生成の設計方針

---

## 📋 決定事項サマリー

### 1. **基本アーキテクチャ：完全動的生成アプローチ（A案）**
- LLMがUIフロー全体を自由に生成
- パターン化は運用の中で上手くいかない部分を抽出して後から実施
- 柔軟性と学習機会を優先

### 2. **3段階フローモデルの採用**
```
探索・発散 → 評価・整理 → 決定・収束 → まとめ確認
```
- **探索・発散**: 可能性を広げ、選択肢を増やす
- **評価・整理**: 選択肢を構造化し、関係性を把握
- **決定・収束**: 優先順位をつけ、方針を確定
- **まとめ確認**: 構造化された文章で結果表示（修正可能）

### 3. **UIコンポーネントのメタデータ設計**

#### 採用するパラメータ
- **`timing`**: 0.0（序盤）～ 1.0（終盤）の連続値
  - フロー内での推奨使用タイミング
  - 重複可能な範囲指定により柔軟な組み合わせを実現
  
- **`versatility`**: 汎用性スコア
  - 高 → 様々な場面で使える（例: 質問カード連鎖）
  - 低 → 特定の状況に限定的（例: 二択比較連鎖）
  - phaseによる離散的な分類より柔軟

#### 廃案となったパラメータ
- **`phase`** (diverge/converge/both) 
  - 理由: 離散的すぎる。timingとversatilityの組み合わせでより細やかな制御が可能

### 4. **Breakdownフェーズへの受け渡し形式**
- **形式**: 1つの長い構造化テキスト
- **内容**: 各UIでのユーザー入力内容を淡々と記録
- **利点**: 
  - 非定型なUI構成でも対応可能
  - 入力の文脈が保持される
  - LLMが後段で要約・解釈しやすい

### 5. **エラーハンドリング方針**
- LLMのUI生成失敗時の復帰フローはクライアント側で実装
- DSLレベルでは規定しない
- 理由: 柔軟性を維持し、実装の自由度を確保

---

## 🎯 コアコンセプト：差別化戦略

### 問題意識
**従来型（静的UI + LLMコンテンツ生成）との差別化が必須**

### 解決アプローチ
**「UIの構造・順序・組み合わせ」自体を悩みに応じて動的生成**

#### 差別化のポイント
| 観点 | 静的UI + コンテンツ生成 | 本アプリ（動的UI生成） |
|------|----------------------|---------------------|
| UI構造 | 固定 | 悩みに応じて変化 |
| フロー | 全員同じ | 個別最適化 |
| 思考支援 | コンテンツで誘導 | インタラクション様式で誘導 |

**例**: 
- 静的UI: 「マトリックスUIに、あなたの悩みに合った項目を表示」
- 動的UI: 「あなたには感情整理→論理分析→直感決定の順が効果的です」

---

## 🧠 設計判断の論理構成

### 判断1: A案（完全LLM生成）の採用

**経緯**:
1. 3つの選択肢を提示（完全LLM / パターン選択 / ハイブリッド）
2. ユーザーが「A案で始めて、上手くいかない部分をパターン化」を選択

**論理**:
- **学習機会の最大化**: 最初からパターンを決めると、想定外の有効なフローを発見できない
- **柔軟性**: 多様な悩みに対応するには自由度が必要
- **段階的改善**: 実データから改善点を抽出する方が設計より効率的

**リスクと対策**:
- リスク: 予測困難な出力、品質のばらつき
- 対策: クライアント側でのフォールバック実装、使用ログからのパターン抽出

---

### 判断2: 3段階モデル + まとめUIの採用

**経緯**:
1. 発散→収束の思考フローを提示
2. ユーザーが「3段階がちょうど良い」と評価
3. ユーザーから「まとめUI追加」の提案

**論理**:
- **認知科学的妥当性**: 人間の問題解決プロセスは発散→収束の構造を持つ
- **シンプルさとバランス**: 2段階では単純すぎ、4段階以上は複雑すぎ
- **ユーザーの介入機会**: まとめUIで最終確認・修正できることで、LLMへの信頼性が向上

**3段階の役割**:
```
1. 探索・発散 (timing 0.0-0.4)
   → 制約なく可能性を広げる
   
2. 評価・整理 (timing 0.3-0.7)
   → 出たアイデアを構造化・関連付け
   
3. 決定・収束 (timing 0.6-1.0)
   → 優先順位をつけて方針確定
   
4. まとめ確認 (timing 1.0)
   → 構造化文章で結果提示+修正可能
```

**timing値の重複の意図**:
- 段階間の境界を曖昧にすることで、スムーズな移行が可能
- 同じUIでも使い方次第で複数段階に跨れる

---

### 判断3: versatility導入 / phase廃止

**経緯**:
1. 当初phase (diverge/converge/both) を提案
2. ユーザーが「versatilityの方が良い」と改善提案

**論理**:
- **連続性**: timingが連続値なのに、phaseが離散値では不整合
- **表現力**: 「どこでも使える度合い」を段階的に表現できる
- **組み合わせ最適化**: LLMがtiming×versatilityの2次元空間で最適なUIを選択可能

**versatilityの活用例**:
- 高versatility (0.8-1.0): 汎用的な質問カード、マインドマップ
- 中versatility (0.4-0.7): 時間軸スライダー、カード仕分け
- 低versatility (0.0-0.3): 二択比較連鎖、トレードオフ天秤
  - 特定の状況（最終決定時など）でのみ有効

---

### 判断4: 長文テキスト形式での受け渡し

**経緯**:
1. 「Breakdownへの受け渡し形式」を質問
2. ユーザーが「1つの長いテキストで構造化して記録」を提案

**論理**:
- **非定型への対応**: UIが毎回異なるため、固定スキーマは困難
- **文脈保持**: 入力の順序や関連性が自然言語で保たれる
- **LLM親和性**: 次段階のLLMが要約・解釈しやすい
- **シンプルさ**: 複雑なデータ構造の設計・保守コストを削減

**イメージ**:
```
【Planフェーズ記録】

ステップ1（感情カラーパレット）:
ユーザーは「不安」を選択し、強度を0.7と設定。
主な懸念は「失敗への恐れ」と特定された。

ステップ2（時間軸スライダー）:
3ヶ月後：現職で安定を維持
1年後：新しいスキルを習得している
3年後：独立して自由に働いている

ステップ3（マトリックスUI）:
[重要度×実現性]で配置された結果、
「副業から始める」が最も現実的と判断。

最終方針：
段階的な独立を目指し、まずは副業で実績を作る。
```

---

## 💡 提案されたUIコンポーネント一覧

### 視覚的思考型
- マインドマップ生成UI
- カード仕分けUI
- シナリオ分岐ツリー

### 分析的思考型
- マトリックス配置UI
- 優先度スライダーグリッド
- トレードオフ天秤

### 直感的思考型
- 感情カラーパレット
- アナロジー選択UI
- 二択比較連鎖

### 対話的思考型（新提案）
- 質問カード連鎖UI
- メンター対話UI（時々選択肢埋め込み）

### 視点転換型（新提案）
- 時間軸スライダー（3ヶ月後/1年後/3年後）
- ペルソナ視点切替（上司/顧客/未来の自分）

### まとめ型（新提案）
- **構造化文章まとめUI**（修正可能）
  - 全ステップの入力を統合して表示
  - ユーザーが最終確認・介入できる

---

## 🔑 重要な設計原則

### 1. **段階的な情報開示**
- ユーザーには一度に1つのUIのみ表示
- 認知負荷を最小化
- フローの自然な進行を促す

### 2. **状態の標準化された受け渡し**
```javascript
{
  "component": "コンポーネント名",
  "user_input": {...},
  "extracted_insights": {...}
}
```

### 3. **適応的な調整**
- ユーザーの行動（入力時間、修正回数）をトラッキング
- 必要に応じてフローを動的に調整
- 例: 「もう1段階、アイデア出しを追加しますか？」

---

## 📝 実装時の留意事項

### LLMへの指示設計のポイント
1. **思考障壁の診断**: 何がユーザーの思考を妨げているか
2. **UIフロー設計**: timing × versatility を考慮した選択
3. **遷移ロジック**: 前段階の出力を次段階でどう活用するか

### コンポーネントライブラリの設計
- 10-15種類のUIコンポーネント（原子）
- 標準化されたI/Oインターフェース
- メタデータ（timing, versatility, cognitive_mode等）

---

## 🎬 次のステップ（参考）

1. **UIコンポーネントの具体的実装**（他メンバーが担当）
2. **LLMプロンプトの精緻化**
3. **A/Bテストによる効果検証**
4. **ログ分析によるパターン抽出**
5. **必要に応じたB案（パターン集）への段階的移行**

---

## 📊 成果物

本議論により、以下が明確化された：

✅ Planフェーズの全体構造（3段階+まとめ）  
✅ UIコンポーネントのメタデータ設計  
✅ LLM動的生成のアプローチ（A案）  
✅ フェーズ間のデータ受け渡し形式  
✅ 静的UIアプリとの明確な差別化ポイント  

---

付録: UIコンポーネントライブラリ例

# UIコンポーネントライブラリ

## 📊 コンポーネント一覧表

| ID | コンポーネント名 | timing | versatility | 認知モード | 主な用途 | 対処するボトルネック |
|----|----------------|--------|-------------|-----------|---------|-------------------|
| **発散・探索フェーズ** |
| UC01 | ブレインストームカード | 0.05 | 0.9 | 自由連想 | 制約なくアイデア創出 | 🔹何から考えればいいか分からない<br>🔹情報不足 |
| UC02 | アナロジー選択UI | 0.15 | 0.7 | 比喩的思考 | 類似事例から枠組み獲得 | 🔹何から考えればいいか分からない<br>🔹視点固定 |
| UC03 | 質問カード連鎖 | 0.2 | 0.85 | 対話的探索 | 深堀り質問で思考を展開 | 🔹情報不足<br>🔹何から考えればいいか分からない |
| UC04 | マインドマップ生成 | 0.25 | 0.75 | 視覚的関連付け | アイデアの関連性を可視化 | 🔹複数の問題が絡んでいる<br>🔹情報が整理されていない |
| UC05 | 感情カラーパレット | 0.1 | 0.6 | 感情的気づき | 感情を可視化・言語化 | 🔹感情的ブロック<br>🔹決断への恐れ |
| **発散・整理の橋渡し** |
| UC06 | 時間軸スライダー | 0.35 | 0.7 | 時間的視点 | 異なる時間軸で発想 | 🔹視点固定<br>🔹選択肢が少ない |
| UC07 | ペルソナ視点切替 | 0.35 | 0.65 | 多角的視点 | 立場を変えて再考 | 🔹視点固定<br>🔹選択肢が少ない |
| UC08 | 問題分解ツリー | 0.4 | 0.7 | 構造的分解 | 大きな問題を小さく分割 | 🔹複数の問題が絡んでいる<br>🔹何から考えればいいか分からない |
| **整理・評価フェーズ** |
| UC09 | カード仕分けUI | 0.45 | 0.8 | カテゴリー化 | アイデアをグルーピング | 🔹選択肢が多すぎる<br>🔹情報が整理されていない |
| UC10 | 依存関係マッピング | 0.5 | 0.55 | 因果関係分析 | 要素間の関係を可視化 | 🔹複数の問題が絡んでいる<br>🔹優先順位がつけられない |
| UC11 | SWOT分析UI | 0.5 | 0.6 | 多面的評価 | 強み/弱み/機会/脅威で整理 | 🔹情報が整理されていない<br>🔹視点固定 |
| **収束・決定フェーズ** |
| UC12 | マトリックス配置 | 0.6 | 0.75 | 二軸評価 | 重要度×実現性等で配置 | 🔹選択肢が多すぎる<br>🔹優先順位がつけられない |
| UC13 | トレードオフ天秤 | 0.7 | 0.5 | バランス調整 | 相反要素の重み付け | 🔹決断への恐れ<br>🔹選択肢が多すぎる |
| UC14 | 優先度スライダーグリッド | 0.75 | 0.65 | 重み付け評価 | 複数軸で重要度調整 | 🔹優先順位がつけられない<br>🔹選択肢が多すぎる |
| UC15 | 二択比較連鎖 | 0.8 | 0.4 | トーナメント式 | ペア比較で最終決定 | 🔹選択肢が多すぎる<br>🔹決断への恐れ |
| UC16 | シナリオ分岐ツリー | 0.85 | 0.55 | 未来シミュレーション | 選択の影響を予測 | 🔹決断への恐れ<br>🔹情報不足 |
| UC17 | リソース配分パイ | 0.75 | 0.5 | 資源配分 | 時間/予算/エネルギー配分 | 🔹優先順位がつけられない<br>🔹複数の問題が絡んでいる |
| **まとめ・確認フェーズ** |
| UC18 | 構造化文章まとめ | 1.0 | 1.0 | 統合・確認 | 全過程を文章化+修正可能 | 🔹全ボトルネック（最終確認） |

---

## 🎯 ボトルネックタイプ別 推奨コンポーネント

### ボトルネック1: 選択肢が多すぎて決められない
**症状**: 可能性がありすぎて絞れない、すべてが重要に見える

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | - | （選択肢を増やさない） |
| 整理 | **UC09 カード仕分け**<br>**UC12 マトリックス配置** | グルーピングで数を減らす<br>視覚的に優劣を判断 |
| 収束 | **UC14 優先度スライダー**<br>**UC15 二択比較連鎖** | 段階的に絞り込む<br>最終的に1つに決定 |

---

### ボトルネック2: 何から考えればいいか分からない
**症状**: 白紙状態、思考の取っ掛かりがない

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC02 アナロジー選択**<br>**UC03 質問カード連鎖**<br>**UC01 ブレインストーム** | 類似事例で枠組み提示<br>質問で思考を誘導<br>自由に書き出す |
| 整理 | **UC08 問題分解ツリー** | 構造化して考える順序を明確化 |

---

### ボトルネック3: 複数の問題が絡んでいる
**症状**: 問題同士が影響し合っている、切り分けられない

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC04 マインドマップ** | 関連性を視覚化 |
| 整理 | **UC08 問題分解ツリー**<br>**UC10 依存関係マッピング** | 問題を分離<br>因果関係を明確化 |
| 収束 | **UC17 リソース配分パイ** | 各問題への投資配分を決定 |

---

### ボトルネック4: 感情的ブロックがある
**症状**: 不安、恐れ、罪悪感が思考を妨げている

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC05 感情カラーパレット** | 感情を可視化・受容 |
| 整理 | **UC07 ペルソナ視点切替** | 感情から距離を取る |
| 収束 | **UC13 トレードオフ天秤** | 感情と論理のバランス調整 |

---

### ボトルネック5: 情報が不足/整理されていない
**症状**: 断片的な情報、全体像が見えない

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC03 質問カード連鎖**<br>**UC01 ブレインストーム** | 不足情報を引き出す |
| 整理 | **UC09 カード仕分け**<br>**UC11 SWOT分析** | 情報を構造化<br>多面的に整理 |

---

### ボトルネック6: 決断への恐れ
**症状**: 失敗が怖い、後戻りできない感覚

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC05 感情カラーパレット** | 恐れを認識 |
| 整理 | **UC06 時間軸スライダー** | 長期視点で相対化 |
| 収束 | **UC16 シナリオ分岐ツリー**<br>**UC15 二択比較連鎖** | リスクをシミュレーション<br>小さな決断の積み重ね |

---

### ボトルネック7: 視点が固定されている
**症状**: 一つの見方しかできない、思い込みがある

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 発散 | **UC02 アナロジー選択**<br>**UC07 ペルソナ視点切替**<br>**UC06 時間軸スライダー** | 異なる文脈で考える<br>他者の立場で考える<br>未来から逆算する |
| 整理 | **UC11 SWOT分析** | 多面的に評価 |

---

### ボトルネック8: 優先順位がつけられない
**症状**: すべてが同じくらい重要に見える

| フェーズ | 推奨コンポーネント | 効果 |
|---------|------------------|------|
| 整理 | **UC10 依存関係マッピング** | 依存関係から順序決定 |
| 収束 | **UC12 マトリックス配置**<br>**UC14 優先度スライダー**<br>**UC17 リソース配分パイ** | 二軸で相対評価<br>重み付けで順位化<br>投資配分で暗黙的に優先順位決定 |

---

## 📐 メタデータ詳細説明

### timing（推奨タイミング）
- **0.0 - 0.3**: 探索・発散フェーズ
- **0.3 - 0.7**: 評価・整理フェーズ
- **0.6 - 1.0**: 決定・収束フェーズ
- **1.0**: まとめ・確認

*重複範囲により、フェーズ間の柔軟な遷移が可能*

### versatility（汎用性）
- **0.8 - 1.0**: 高汎用（ほぼすべての悩みに使える）
- **0.5 - 0.7**: 中汎用（特定のタイプの悩みに有効）
- **0.0 - 0.4**: 低汎用（限定的な状況で強力）

### 認知モード
- **自由連想**: 制約のない思考
- **比喩的思考**: アナロジー・メタファー
- **対話的探索**: 質問による掘り下げ
- **視覚的関連付け**: 空間配置による理解
- **感情的気づき**: 感情の認識と言語化
- **時間的視点**: 過去/現在/未来の視点切替
- **多角的視点**: 複数の立場からの検討
- **構造的分解**: 階層化・カテゴリー化
- **因果関係分析**: 原因と結果の関係
- **二軸評価**: 2つの基準による評価
- **バランス調整**: トレードオフの最適化
- **未来シミュレーション**: if-thenの予測

---

## 🔧 LLM生成時の活用方法

### コンポーネント選択アルゴリズム例

```javascript
function selectUIComponents(captureData, bottlenecks) {
  // 1. ボトルネック分析
  const primaryBottleneck = analyzePrimaryBottleneck(bottlenecks);
  
  // 2. フェーズごとに候補を選択
  const divergeComponents = filterByTiming(0.0, 0.4)
    .filterByBottleneck(primaryBottleneck)
    .sortByVersatility('desc');
  
  const convergeComponents = filterByTiming(0.6, 1.0)
    .filterByBottleneck(primaryBottleneck)
    .sortByVersatility('desc');
  
  // 3. フロー構築
  return [
    divergeComponents[0],      // 発散
    bridgeComponent,           // 橋渡し（任意）
    convergeComponents[0],     // 収束
    summaryComponent          // まとめ（UC18固定）
  ];
}
```

---

## 💡 実践的な使用例

### 例1: 「転職すべきか悩んでいる」
**ボトルネック診断**: 感情的ブロック + 決断への恐れ

**推奨フロー**:
1. **UC05 感情カラーパレット** (timing: 0.1)
   - 不安・恐れを可視化
2. **UC06 時間軸スライダー** (timing: 0.35)
   - 3ヶ月後/1年後/3年後で考える
3. **UC16 シナリオ分岐ツリー** (timing: 0.85)
   - 転職した場合/しない場合をシミュレーション
4. **UC18 構造化文章まとめ** (timing: 1.0)

---

### 例2: 「プロジェクトの優先順位が決められない」
**ボトルネック診断**: 選択肢が多すぎる + 優先順位がつけられない

**推奨フロー**:
1. **UC09 カード仕分けUI** (timing: 0.45)
   - プロジェクトを「緊急度」でグルーピング
2. **UC12 マトリックス配置** (timing: 0.6)
   - 「重要度×実現性」で配置
3. **UC14 優先度スライダーグリッド** (timing: 0.75)
   - 最終的な重み付け
4. **UC18 構造化文章まとめ** (timing: 1.0)

---

### 例3: 「キャリアの方向性が見えない」
**ボトルネック診断**: 何から考えればいいか分からない + 視点固定

**推奨フロー**:
1. **UC02 アナロジー選択UI** (timing: 0.15)
   - 「似ているキャリアパス」を選択
2. **UC07 ペルソナ視点切替** (timing: 0.35)
   - 「5年後の自分」「尊敬する人」の視点
3. **UC08 問題分解ツリー** (timing: 0.4)
   - 「キャリア」を要素分解
4. **UC12 マトリックス配置** (timing: 0.6)
   - 選択肢を「情熱×市場性」で評価
5. **UC18 構造化文章まとめ** (timing: 1.0)

---

この表を基に、LLMが動的にUIフローを生成する際の参照データとして活用できます。
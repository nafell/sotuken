# DSL v3 åŸºæœ¬è¨­è¨ˆæ›¸ï¼ˆæ¦‚å¿µè¨­è¨ˆ/å¤–éƒ¨è¨­è¨ˆï¼‰

**ä½œæˆæ—¥**: 2025-01-17
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.0
**å¯¾è±¡ã‚·ã‚¹ãƒ†ãƒ **: æ€è€ƒæ•´ç†ã‚¢ãƒ—ãƒªå‹•çš„UIç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ 
**è¨­è¨ˆè€…**: TK

---

## ğŸ“‹ ç›®æ¬¡

1. [è¨­è¨ˆç›®çš„ã¨èƒŒæ™¯](#1-è¨­è¨ˆç›®çš„ã¨èƒŒæ™¯)
2. [ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£](#2-ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£)
3. [Widgetå…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ](#3-widgetå…±é€šã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ)
4. [Dependency Graphè¨­è¨ˆ](#4-dependency-graphè¨­è¨ˆ)
5. [ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ](#5-ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ)
6. [Stateç®¡ç†è¨­è¨ˆ](#6-stateç®¡ç†è¨­è¨ˆ)
7. [å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹](#7-å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹)
8. [éæ©Ÿèƒ½è¦æ±‚](#8-éæ©Ÿèƒ½è¦æ±‚)

---

## 1. è¨­è¨ˆç›®çš„ã¨èƒŒæ™¯

### 1.1 ç›®çš„

æœ¬è¨­è¨ˆæ›¸ã¯ã€DSL v3ã«ãŠã‘ã‚‹å‹•çš„UIç”Ÿæˆã‚·ã‚¹ãƒ†ãƒ ã®æ¦‚å¿µè¨­è¨ˆã¨å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®šç¾©ã™ã‚‹ã€‚

**ä¸»è¦ç›®æ¨™**:
1. Domain-Specificå‹•çš„UIç”Ÿæˆã®å®Ÿç¾
2. Widget-to-Widget Reactivityã®ã‚µãƒãƒ¼ãƒˆ
3. ãƒˆãƒ¼ã‚¯ãƒ³ä½¿ç”¨é‡ã®å‰Šæ¸›ï¼ˆvs Jelly: 30%ä»¥ä¸Šï¼‰
4. æ€è€ƒæ•´ç†ã‚¿ã‚¹ã‚¯ã«ç‰¹åŒ–ã—ãŸè¨­è¨ˆ

### 1.2 èƒŒæ™¯

#### å…ˆè¡Œç ”ç©¶ï¼ˆJellyï¼‰ã¨ã®æ¯”è¼ƒ

| è¦³ç‚¹ | Jellyï¼ˆGeneralï¼‰ | æœ¬ã‚·ã‚¹ãƒ†ãƒ ï¼ˆDomain-Specificï¼‰ |
|------|-----------------|--------------------------|
| é©ç”¨é ˜åŸŸ | ã‚ã‚‰ã‚†ã‚‹ã‚¿ã‚¹ã‚¯ | æ€è€ƒæ•´ç†ã«ç‰¹åŒ– |
| DSLè¦ç´ æ•° | å¤šï¼ˆ~50è¦ç´ ï¼‰ | å°‘ï¼ˆ~20è¦ç´ ï¼‰ |
| ãƒˆãƒ¼ã‚¯ãƒ³æ•° | å¤š | å°‘ï¼ˆ30-50%å‰Šæ¸›ï¼‰ |
| Reactivity | Item-to-Item | **Widget-to-Widget** â­ |
| UIãƒ•ãƒ­ãƒ¼ | å˜ç™ºç”Ÿæˆ | **æ®µéšçš„ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ** â­ |
| ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ« | æ¯å›å†æ§‹ç¯‰ | **æ®µéšçš„è“„ç©** â­ |

#### ç ”ç©¶ã®æ–°è¦æ€§

1. **Domain-Specificã‚¢ãƒ—ãƒ­ãƒ¼ãƒ**
   - **ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã‚’8-12ç¨®é¡ã«é™å®š**ï¼ˆLLMã¯ç”Ÿæˆã§ã¯ãªãé¸å®šï¼‰
   - æ€è€ƒæ•´ç†ç‰¹æœ‰ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
   - 3ã‚¹ãƒ†ãƒ¼ã‚¸æ§‹é€ ï¼ˆç™ºæ•£â†’æ•´ç†â†’åæŸï¼‰
   - **LLMã¯Widgetã‚’ç”Ÿæˆã›ãšã€ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰æœ€é©ãªWidgetã‚’é¸å®š**

2. **Widget-to-Widget Reactivity**
   - **LLMã®å‹•çš„ç”Ÿæˆå¯¾è±¡ã¯Widgetè‡ªä½“ã§ã¯ãªãã€Widgeté–“ã®ä¾å­˜é–¢ä¿‚ï¼ˆDpGï¼‰**
   - åŒä¸€ç”»é¢ä¸Šã§ã®Widgeté–“é€£å‹•ã‚’Dependency Graphã§å®šç¾©
   - å‰æ®µéšã®å‡ºåŠ›ãŒæ¬¡æ®µéšã®UIè¨­å®šã«å½±éŸ¿
   - Dependency Graphã«ã‚ˆã‚‹ä¾å­˜é–¢ä¿‚ç®¡ç†

### 1.3 è¨­è¨ˆæ–¹é‡

1. **æŠ½è±¡åŒ–ã¨å…·è±¡åŒ–ã®åˆ†é›¢**
   - Widgetä»•æ§˜ï¼ˆæŠ½è±¡ï¼‰ã¨Widgetå®Ÿè£…ï¼ˆå…·è±¡ï¼‰ã‚’åˆ†é›¢
   - DSLã‹ã‚‰ç”Ÿæˆã•ã‚Œã‚‹ä»•æ§˜ã¨ã€Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å®Ÿè£…ã‚’ç‹¬ç«‹ã•ã›ã‚‹

2. **æ§‹é€ åŒ–ã•ã‚ŒãŸçµæœå‡ºåŠ›**
   - å„Widgetã¯`WidgetResult`ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…
   - äººé–“ãŒèª­ã‚ã‚‹è¦ç´„ï¼ˆsummaryï¼‰ã¨æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼ˆdataï¼‰ã‚’ä¸¡æ–¹å‡ºåŠ›

3. **æ‹¡å¼µæ€§ã®ç¢ºä¿**
   - æ–°ã—ã„Widgetã‚¿ã‚¤ãƒ—ã‚’è¿½åŠ ã—ã‚„ã™ã„è¨­è¨ˆ
   - ã‚«ã‚¹ã‚¿ãƒ å¤‰æ›é–¢æ•°ã®è¿½åŠ ãŒå®¹æ˜“

4. **å‹å®‰å…¨æ€§**
   - TypeScriptã®å‹ã‚·ã‚¹ãƒ†ãƒ ã‚’æœ€å¤§é™æ´»ç”¨
   - ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ã‚¨ãƒ©ãƒ¼ã‚’æ¤œå‡º

---

## 2. ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### 2.1 DSLã¨å®Ÿè£…ã®åˆ†é›¢

ã‚·ã‚¹ãƒ†ãƒ ã¯**DSLå±¤ï¼ˆLLMç”Ÿæˆï¼‰**ã¨**å®Ÿè£…å±¤ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰**ã«æ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã¾ã™ã€‚

#### DSLå±¤ï¼ˆLLMç”Ÿæˆã•ã‚Œã‚‹æŠ½è±¡ä»•æ§˜ï¼‰

Jellyã®3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ç¶™æ‰¿ï¼š

1. **OODM (Object-Oriented Data Model)**
   - ã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©
   - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å±æ€§ã€é–¢ä¿‚æ€§
   - LLMãŒç”Ÿæˆã™ã‚‹DSL

2. **DpG (Dependency Graph)**
   - Widgeté–“ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©
   - ã‚½ãƒ¼ã‚¹ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã€ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã€é–¢ä¿‚æ€§
   - LLMãŒç”Ÿæˆã™ã‚‹DSL

3. **UISpec (UI Specification)**
   - ç”»é¢å…¨ä½“ã®UIæ§‹æˆã‚’å®šç¾©
   - è¤‡æ•°ã®WidgetSpecã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼
   - LLMãŒç”Ÿæˆã™ã‚‹DSL

#### å®Ÿè£…å±¤ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰

DSLã‚’è§£é‡ˆã—ã¦å®Ÿéš›ã®UIã‚’ç”Ÿæˆï¼š

1. **DSL Parser**
   - DSL â†’ TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›

2. **Widget Registry**
   - WidgetSpec â†’ React Componentã®ãƒãƒƒãƒ”ãƒ³ã‚°

3. **Renderer**
   - UISpecã«åŸºã¥ã„ã¦Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æç”»

4. **State Manager**
   - Jotaiã«ã‚ˆã‚‹ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªçŠ¶æ…‹ç®¡ç†

5. **Dependency Executor**
   - DpGã«åŸºã¥ã„ã¦ä¾å­˜é–¢ä¿‚ã‚’å®Ÿè¡Œ

### 2.2 3å±¤DSLã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ï¼ˆJellyãƒ™ãƒ¼ã‚¹ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Layer 1: OODM (DSL)                  â”‚
â”‚   Object-Oriented Data Model                    â”‚
â”‚   - ãƒ‡ãƒ¼ã‚¿æ§‹é€ å®šç¾©                               â”‚
â”‚   - ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨å±æ€§                           â”‚
â”‚   - ã‚¹ã‚­ãƒ¼ãƒå®šç¾©                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Layer 2: DpG (DSL)                      â”‚
â”‚   Dependency Graph                               â”‚
â”‚   - Widgeté–“ã®ä¾å­˜é–¢ä¿‚                           â”‚
â”‚   - ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å®šç¾©                             â”‚
â”‚   - Reactive Bindingå®šç¾©                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Layer 3: UISpec (DSL)                   â”‚
â”‚   UI Specification                               â”‚
â”‚   - ç”»é¢å…¨ä½“ã®æ§‹æˆ                               â”‚
â”‚   - WidgetSpec[] (è¤‡æ•°Widget)                   â”‚
â”‚   - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.3 å®Œå…¨ãªãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

```
ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã€‘
ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‚©ã¿ï¼ˆè‡ªç„¶è¨€èªï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            Captureãƒ•ã‚§ãƒ¼ã‚º                       â”‚
â”‚   - æ‚©ã¿ãƒ†ã‚­ã‚¹ãƒˆ                                 â”‚
â”‚   - ã‚¿ã‚°é¸æŠ                                     â”‚
â”‚   - ç°¡æ˜“å•è¨º                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Captureãƒ‡ãƒ¼ã‚¿ï¼ˆæ§‹é€ åŒ–ï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ã€LLMç”Ÿæˆ Step 1ã€‘                      â”‚
â”‚   OODM + DpG + Widgeté¸å®š                      â”‚
â”‚                                                  â”‚
â”‚   Input:  Captureãƒ‡ãƒ¼ã‚¿                         â”‚
â”‚           ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetä¸€è¦§ (8-12ç¨®)         â”‚
â”‚   Output: OODM (DSL)                            â”‚
â”‚           DpG (DSL)                             â”‚
â”‚           é¸å®šã•ã‚ŒãŸWidget ID[]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
OODM + DpG + Widgeté¸å®šçµæœï¼ˆDSLã€TOONè¨˜æ³•ï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ã€LLMç”Ÿæˆ Step 2ã€‘                      â”‚
â”‚   UISpecç”Ÿæˆï¼ˆWidgetè¨­å®š + ä¾å­˜é–¢ä¿‚è©³ç´°åŒ–ï¼‰    â”‚
â”‚                                                  â”‚
â”‚   Input:  OODM + DpG                            â”‚
â”‚           é¸å®šã•ã‚ŒãŸWidget ID[]                 â”‚
â”‚   Output: UISpec (DSL)                          â”‚
â”‚             â””â”€ WidgetSpec[] (é¸å®šWidgetã®è¨­å®š) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
UISpecï¼ˆDSLã€TOONè¨˜æ³•ï¼‰
  â””â”€ WidgetSpec (Widget 1)
  â””â”€ WidgetSpec (Widget 2)
  â””â”€ WidgetSpec (Widget 3)
  â””â”€ ...
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ã€ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã€‘                â”‚
â”‚   DSL Parser â†’ TypeScript Objects              â”‚
â”‚                                                  â”‚
â”‚   1. UISpec â†’ UISpecObject (TypeScript)        â”‚
â”‚   2. WidgetSpec[] â†’ WidgetSpecObject[]         â”‚
â”‚   3. DpG â†’ DependencyGraph (å®Ÿè£…ã‚¯ãƒ©ã‚¹)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ã€Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç”Ÿæˆã€‘                 â”‚
â”‚   Widget Renderer                                â”‚
â”‚                                                  â”‚
â”‚   WidgetRegistry.get(spec.component)            â”‚
â”‚   â†’ React Component                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
React Widget Componentsï¼ˆå®Ÿè£…ï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã€‘                    â”‚
â”‚   - å…¥åŠ›ã€é¸æŠã€èª¿æ•´                             â”‚
â”‚   - Stateæ›´æ–°ï¼ˆJotaiï¼‰                          â”‚
â”‚   - Reactive Bindingå®Ÿè¡Œ                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Widget Resultsï¼ˆWidgetResult[]ï¼‰
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ã€çµæœé›†ç´„ã€‘                        â”‚
â”‚   SessionResultAggregator                       â”‚
â”‚   - æ§‹é€ åŒ–ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆ                           â”‚
â”‚   - ãƒ‡ãƒ¼ã‚¿çµ±åˆ                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Planãƒ•ã‚§ãƒ¼ã‚ºè¨˜éŒ²
    â†“
ã€Breakdownãƒ•ã‚§ãƒ¼ã‚ºã¸ã€‘
```

### 2.4 DSLã¨å®Ÿè£…ã®å¯¾å¿œé–¢ä¿‚

| DSLï¼ˆæŠ½è±¡ä»•æ§˜ï¼‰ | å®Ÿè£…ï¼ˆå…·è±¡ã‚³ãƒ¼ãƒ‰ï¼‰ | å½¹å‰² |
|----------------|-------------------|------|
| **OODM** | - | ãƒ‡ãƒ¼ã‚¿æ§‹é€ å®šç¾©ï¼ˆæ¬¡æ®µéšã®UISpecç”Ÿæˆã§ä½¿ç”¨ï¼‰ |
| **DpG** | `DependencyGraph`ã‚¯ãƒ©ã‚¹ | ä¾å­˜é–¢ä¿‚ã®å®Ÿè¡Œã‚¨ãƒ³ã‚¸ãƒ³ |
| **UISpec** | `UIRenderer`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ç”»é¢å…¨ä½“ã®æç”» |
| **WidgetSpec** | `BaseWidgetController` + React Component | å€‹åˆ¥Widgetã®å®Ÿè£… |
| - | `WidgetRegistry` | WidgetSpec â†’ React Componentã®ãƒãƒƒãƒ”ãƒ³ã‚° |
| - | Jotai Atoms | Stateç®¡ç† |
| - | `DependencyExecutor` | ä¾å­˜é–¢ä¿‚ã®å®Ÿè¡Œ |

### 2.3 ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

#### 2.3.1 DSL Parser
- **è²¬å‹™**: DSL v3ãƒ†ã‚­ã‚¹ãƒˆã‚’WidgetSpec[]ã«å¤‰æ›
- **å…¥åŠ›**: DSL v3ï¼ˆTOONè¨˜æ³•ï¼‰
- **å‡ºåŠ›**: WidgetSpec[]

#### 2.3.2 Widget Registry
- **è²¬å‹™**: ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã®ç®¡ç†ã¨Widgetã‚¿ã‚¤ãƒ—ã¨å®Ÿè£…ã®å¯¾å¿œä»˜ã‘
- **æ©Ÿèƒ½**:
  - **ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetï¼ˆ12ç¨®ï¼‰ã‚’äº‹å‰ã«ç™»éŒ²**
  - Widgetã‚¿ã‚¤ãƒ—åï¼ˆcomponent IDï¼‰ã‹ã‚‰Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å–å¾—
  - Widgetãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®ç®¡ç†ï¼ˆé©ç”¨å¯èƒ½ãªæ€è€ƒãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã€æ¨å¥¨ã‚¹ãƒ†ãƒ¼ã‚¸ï¼‰
  - LLMç”¨ã®Widgetä¸€è¦§ã¨ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã®æä¾›

**ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetï¼ˆ12ç¨®ï¼‰**:

| ID | åç§° | ã‚¹ãƒ†ãƒ¼ã‚¸ | å¯¾è±¡ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ | DSLv3 UC |
|----|------|---------|----------------|---------|
| `brainstorm_cards` | ãƒ–ãƒ¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ ã‚«ãƒ¼ãƒ‰ | diverge | ä½•ã‹ã‚‰è€ƒãˆã‚Œã°ã„ã„ã‹åˆ†ã‹ã‚‰ãªã„ã€æƒ…å ±ä¸è¶³ | UC01 |
| `question_card_chain` | è³ªå•ã‚«ãƒ¼ãƒ‰é€£é– | diverge | æƒ…å ±ä¸è¶³ã€ä½•ã‹ã‚‰è€ƒãˆã‚Œã°ã„ã„ã‹åˆ†ã‹ã‚‰ãªã„ | UC03 |
| `emotion_palette` | æ„Ÿæƒ…ã‚«ãƒ©ãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ | diverge | æ„Ÿæƒ…çš„ãƒ–ãƒ­ãƒƒã‚¯ã€æ±ºæ–­ã¸ã®æã‚Œ | UC05 |
| `card_sorting` | ã‚«ãƒ¼ãƒ‰ä»•åˆ†ã‘UI | organize | é¸æŠè‚¢ãŒå¤šã™ãã‚‹ã€æƒ…å ±ãŒæ•´ç†ã•ã‚Œã¦ã„ãªã„ | UC09 |
| `dependency_mapping` | ä¾å­˜é–¢ä¿‚ãƒãƒƒãƒ”ãƒ³ã‚° | organize | è¤‡æ•°ã®å•é¡ŒãŒçµ¡ã‚“ã§ã„ã‚‹ã€å„ªå…ˆé †ä½ãŒã¤ã‘ã‚‰ã‚Œãªã„ | UC10 |
| `swot_analysis` | SWOTåˆ†æUI | organize | æƒ…å ±ãŒæ•´ç†ã•ã‚Œã¦ã„ãªã„ã€è¦–ç‚¹å›ºå®š | UC11 |
| `mind_map` | ãƒã‚¤ãƒ³ãƒ‰ãƒãƒƒãƒ—ç”Ÿæˆ | organize | è¤‡æ•°ã®å•é¡ŒãŒçµ¡ã‚“ã§ã„ã‚‹ã€æƒ…å ±ãŒæ•´ç†ã•ã‚Œã¦ã„ãªã„ | UC04 |
| `matrix_placement` | ãƒãƒˆãƒªãƒƒã‚¯ã‚¹é…ç½® | converge | é¸æŠè‚¢ãŒå¤šã™ãã‚‹ã€å„ªå…ˆé †ä½ãŒã¤ã‘ã‚‰ã‚Œãªã„ | UC12 |
| `tradeoff_balance` | ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•å¤©ç§¤ | converge | æ±ºæ–­ã¸ã®æã‚Œã€é¸æŠè‚¢ãŒå¤šã™ãã‚‹ | UC13 |
| `priority_slider_grid` | å„ªå…ˆåº¦ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚°ãƒªãƒƒãƒ‰ | converge | å„ªå…ˆé †ä½ãŒã¤ã‘ã‚‰ã‚Œãªã„ã€é¸æŠè‚¢ãŒå¤šã™ãã‚‹ | UC14 |
| `timeline_slider` | æ™‚é–“è»¸ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ | converge | è¦–ç‚¹å›ºå®šã€é¸æŠè‚¢ãŒå°‘ãªã„ | UC06 |
| `structured_summary` | æ§‹é€ åŒ–æ–‡ç« ã¾ã¨ã‚ | summary | å…¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ï¼ˆæœ€çµ‚ç¢ºèªï¼‰ | UC18 |

#### 2.3.3 Dependency Graph Manager
- **è²¬å‹™**: Widgeté–“ã®ä¾å­˜é–¢ä¿‚ç®¡ç†
- **æ©Ÿèƒ½**:
  - ä¾å­˜é–¢ä¿‚ã®ç™»éŒ²ãƒ»å‰Šé™¤
  - å¾ªç’°ä¾å­˜ã®æ¤œå‡º
  - æ›´æ–°é †åºã®æ±ºå®š

#### 2.3.4 State Manager (Jotai)
- **è²¬å‹™**: Widgeté–“ã®ãƒªã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªStateç®¡ç†
- **æ©Ÿèƒ½**:
  - Atomã®å‹•çš„ç”Ÿæˆ
  - æ´¾ç”ŸAtomã®è‡ªå‹•æ›´æ–°
  - Reactive Bindingã®å®Ÿè¡Œ

#### 2.3.5 Widget Renderer
- **è²¬å‹™**: WidgetSpecã‹ã‚‰Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- **æ©Ÿèƒ½**:
  - å‹•çš„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆç”Ÿæˆ
  - ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†ï¼ˆå˜ç‹¬/å·¦å³åˆ†å‰²/ä¸Šä¸‹åˆ†å‰²ï¼‰

#### 2.3.6 Session Result Aggregator
- **è²¬å‹™**: Widgetã®çµæœã‚’é›†ç´„
- **æ©Ÿèƒ½**:
  - WidgetResultã®åé›†
  - æ§‹é€ åŒ–ãƒ†ã‚­ã‚¹ãƒˆã®ç”Ÿæˆ
  - Breakdownãƒ•ã‚§ãƒ¼ã‚ºã¸ã®ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—

---

## 3. UISpec/WidgetSpecéšå±¤è¨­è¨ˆ

### 3.1 è¨­è¨ˆåŸå‰‡

1. **DSLã¨å®Ÿè£…ã®åˆ†é›¢**
   - **UISpec/WidgetSpec**: LLMç”Ÿæˆã•ã‚Œã‚‹DSLï¼ˆæŠ½è±¡ä»•æ§˜ï¼‰
   - **å®Ÿè£…ã‚³ãƒ¼ãƒ‰**: ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã‚‹Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

2. **éšå±¤æ§‹é€ **
   - **UISpecï¼ˆç”»é¢å…¨ä½“ï¼‰** â†’ **WidgetSpec[]ï¼ˆå€‹åˆ¥Widgetï¼‰**
   - 1ã¤ã®UISpecãŒè¤‡æ•°ã®WidgetSpecã‚’å†…åŒ…

3. **æŠ½è±¡çš„ãªçµæœè¡¨ç¾**
   - `StructuredData`å‹ã§å„ç¨®Widgetå‡ºåŠ›ã‚’æŠ½è±¡åŒ–
   - selection, ranking, mapping, text, compositeã®5ã‚¿ã‚¤ãƒ—

4. **å†…éƒ¨å®Ÿè£…ã®éš è”½**
   - LLMæ©Ÿèƒ½ã¯Widgetå†…éƒ¨å®Ÿè£…
   - å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã«ã¯éœ²å‡ºã—ãªã„

### 3.2 DSLéšå±¤æ§‹é€ 

```
UISpec (ç”»é¢å…¨ä½“ã®ä»•æ§˜ã€DSL)
  â”œâ”€ sessionId: string
  â”œâ”€ stage: 'diverge' | 'organize' | 'converge' | 'summary'
  â”œâ”€ oodm: OODM (ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«å®šç¾©ã€DSL)
  â”œâ”€ dpg: DependencyGraph (ä¾å­˜é–¢ä¿‚å®šç¾©ã€DSL)
  â””â”€ widgets: WidgetSpec[] (è¤‡æ•°ã®Widgetä»•æ§˜ã€DSL)
       â”œâ”€ WidgetSpec 1
       â”œâ”€ WidgetSpec 2
       â”œâ”€ WidgetSpec 3
       â””â”€ ...
```

### 3.3 ä¸»è¦DSLã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆLLMç”Ÿæˆï¼‰

#### UISpecï¼ˆç”»é¢å…¨ä½“ã®ä»•æ§˜ã€DSLï¼‰

LLMãŒç”Ÿæˆã™ã‚‹ã€Planãƒ•ã‚§ãƒ¼ã‚º1ã‚¹ãƒ†ãƒ¼ã‚¸åˆ†ã®ç”»é¢å…¨ä½“ã®ä»•æ§˜ã€‚

```
UISpec (DSL) {
  sessionId: string             // ã‚»ãƒƒã‚·ãƒ§ãƒ³ID
  stage: StageType              // ç™ºæ•£/æ•´ç†/åæŸ/ã¾ã¨ã‚
  oodm: OODM                    // ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ï¼ˆDSLï¼‰
  dpg: DependencyGraphSpec      // ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ï¼ˆDSLï¼‰
  widgets: WidgetSpec[]         // Widgetä»•æ§˜ã®é…åˆ—ï¼ˆDSLï¼‰
  layout: ScreenLayout          // ç”»é¢ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
  metadata: {
    generatedAt: number         // ç”Ÿæˆæ™‚åˆ»
    llmModel: string            // ä½¿ç”¨ã—ãŸLLMãƒ¢ãƒ‡ãƒ«
    tokenCount: number          // ä½¿ç”¨ãƒˆãƒ¼ã‚¯ãƒ³æ•°
  }
}
```

**ç”Ÿæˆå…ƒ**: LLMï¼ˆGemini 2.5 miniï¼‰
**ç”¨é€”**: DSL ParserãŒãƒ‘ãƒ¼ã‚¹ã—ã€UI RendererãŒæç”»

#### WidgetSpecï¼ˆå€‹åˆ¥Widgetã®ä»•æ§˜ã€DSLï¼‰

**LLMãŒç”Ÿæˆã™ã‚‹ã€ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã¸ã®å‚ç…§ã¨è¨­å®šã‚’å®šç¾©ã™ã‚‹ä»•æ§˜**ã€‚

**é‡è¦**: WidgetSpecã¯Widgetè‡ªä½“ã‚’è¨˜è¿°ã™ã‚‹ã®ã§ã¯ãªãã€**ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã®ã©ã‚Œã‚’ä½¿ã†ã‹ï¼ˆcomponentï¼‰ã¨ãã®è¨­å®šï¼ˆconfigï¼‰ã‚’æŒ‡å®šã™ã‚‹**ã€‚

```
WidgetSpec (DSL) {
  id: string                    // ä¸€æ„è­˜åˆ¥å­
  component: WidgetComponentType // ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã®IDï¼ˆä¾‹: 'emotion_palette'ï¼‰
  position: number              // ç”»é¢å†…ã§ã®è¡¨ç¤ºé †åº
  layout?: LayoutType           // å˜ç‹¬/å·¦å³åˆ†å‰²/ä¸Šä¸‹åˆ†å‰²
  config: WidgetConfig          // ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã¸ã®è¨­å®šãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆDSLï¼‰
  inputs?: DataBinding[]        // å…¥åŠ›ãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼ˆDSLï¼‰
  outputs?: DataBinding[]       // å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿å®šç¾©ï¼ˆDSLï¼‰
  reactiveBindings?: ReactiveBinding[] // Reactiveé€£å‹•å®šç¾©ï¼ˆDSLï¼‰
  metadata: WidgetMetadata      // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
}
```

**ç”Ÿæˆå…ƒ**: LLMï¼ˆGemini 2.5 miniï¼‰ãŒ**ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetä¸€è¦§ã‹ã‚‰é¸å®šã—ã€è¨­å®šã‚’ç”Ÿæˆ**
**ç”¨é€”**: Widget RegistryãŒcomponentIDã«å¯¾å¿œã™ã‚‹Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å–å¾—

### 3.4 å®Ÿè£…ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ï¼ˆTypeScriptï¼‰

#### UISpecObjectï¼ˆãƒ‘ãƒ¼ã‚¹å¾Œã®TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰

DSL ParserãŒUISpecï¼ˆDSLï¼‰ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ç”Ÿæˆã™ã‚‹TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚

```typescript
// concern-app/src/types/ui-spec.types.ts

interface UISpecObject {
  sessionId: string;
  stage: StageType;
  oodm: OODMObject;
  dpg: DependencyGraph;        // å®Ÿè£…ã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
  widgets: WidgetSpecObject[]; // ãƒ‘ãƒ¼ã‚¹æ¸ˆã¿Widgetä»•æ§˜
  layout: ScreenLayout;
  metadata: UISpecMetadata;
}
```

**ç”Ÿæˆå…ƒ**: DSL Parserï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰
**ç”¨é€”**: UI RendererãŒä½¿ç”¨

#### WidgetSpecObjectï¼ˆãƒ‘ãƒ¼ã‚¹å¾Œã®TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼‰

DSL ParserãŒWidgetSpecï¼ˆDSLï¼‰ã‚’ãƒ‘ãƒ¼ã‚¹ã—ã¦ç”Ÿæˆã™ã‚‹TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚

```typescript
interface WidgetSpecObject {
  id: string;
  component: WidgetComponentType;
  position: number;
  layout?: LayoutType;
  config: Record<string, any>;  // ãƒ‘ãƒ¼ã‚¹æ¸ˆã¿è¨­å®š
  inputs?: DataBindingObject[];
  outputs?: DataBindingObject[];
  reactiveBindings?: ReactiveBindingObject[];
  metadata: WidgetMetadata;
}
```

**ç”Ÿæˆå…ƒ**: DSL Parserï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ï¼‰
**ç”¨é€”**: Widget RendererãŒå¯¾å¿œã™ã‚‹Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”Ÿæˆ

#### WidgetResultï¼ˆWidgetçµæœï¼‰

WidgetãŒå‡ºåŠ›ã™ã‚‹æ§‹é€ åŒ–ã•ã‚ŒãŸçµæœã€‚

```
WidgetResult {
  widgetId: string              // Widget ID
  component: string             // ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚¿ã‚¤ãƒ—
  timestamp: number             // å®Œäº†æ™‚åˆ»
  summary: string               // äººé–“ãŒèª­ã‚ã‚‹è¦ç´„
  data: StructuredData          // æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿
  interactions?: UserInteraction[] // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œè¨˜éŒ²
  metadata?: Record<string, any>   // Widgetå›ºæœ‰ã®ãƒ¡ã‚¿æƒ…å ±
}
```

**ç”¨é€”**:
- å„WidgetãŒ`getResult()`ãƒ¡ã‚½ãƒƒãƒ‰ã§è¿”ã™
- Session Result AggregatorãŒåé›†
- Breakdownãƒ•ã‚§ãƒ¼ã‚ºã¸ã®å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨

#### StructuredDataï¼ˆæ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ï¼‰

Widgetã®å‡ºåŠ›ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½è±¡åŒ–ã—ãŸå‹ã€‚

```
StructuredData {
  type: 'selection' | 'ranking' | 'mapping' | 'text' | 'composite'

  // é¸æŠå‹ï¼ˆä¾‹: EmotionPaletteï¼‰
  selection?: {
    selected: string | string[]
    options: string[]
    metadata?: Record<string, any>
  }

  // ãƒ©ãƒ³ã‚­ãƒ³ã‚°å‹ï¼ˆä¾‹: PrioritySliderGridï¼‰
  ranking?: {
    items: Array<{
      id: string
      label: string
      score: number
      metadata?: Record<string, any>
    }>
  }

  // ãƒãƒƒãƒ”ãƒ³ã‚°å‹ï¼ˆä¾‹: MatrixPlacement, DependencyMappingï¼‰
  mapping?: {
    items: Array<{
      id: string
      label: string
      position?: { x: number; y: number }
      category?: string
      relations?: string[]
    }>
  }

  // ãƒ†ã‚­ã‚¹ãƒˆå‹ï¼ˆä¾‹: BrainstormCardsï¼‰
  text?: {
    content: string
    structured?: Record<string, any>
  }

  // è¤‡åˆå‹ï¼ˆè¤‡æ•°ã®ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—ã‚’å«ã‚€ï¼‰
  composite?: Record<string, any>
}
```

### 3.3 Widgetç”Ÿæˆã‹ã‚‰çµæœå–å¾—ã¾ã§ã®ãƒ•ãƒ­ãƒ¼

```
1. DSLç”Ÿæˆ
   LLM â†’ DSL v3ãƒ†ã‚­ã‚¹ãƒˆ

2. ãƒ‘ãƒ¼ã‚¹
   DSL Parser â†’ WidgetSpec[]

3. ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
   Widget Renderer â†’ React Component

4. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
   User â†’ Widget UI

5. çµæœç”Ÿæˆ
   Widget Controller â†’ WidgetResult

6. çµæœé›†ç´„
   Session Result Aggregator â†’ Planè¨˜éŒ²
```

---

## 4. Dependency Graphè¨­è¨ˆ

### 4.1 è¨­è¨ˆç›®çš„

Widgeté–“ã®ä¾å­˜é–¢ä¿‚ã‚’ç®¡ç†ã—ã€ä»¥ä¸‹ã‚’å®Ÿç¾ã™ã‚‹ï¼š

1. **ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•ä¼æ’­**
   - WidgetAã®å‡ºåŠ›ãŒWidgetBã®å…¥åŠ›/è¨­å®šã«è‡ªå‹•åæ˜ 

2. **æ›´æ–°é †åºã®æ±ºå®š**
   - ä¾å­˜é–¢ä¿‚ã‚’è€ƒæ…®ã—ãŸæ­£ã—ã„æ›´æ–°é †åº

3. **å¾ªç’°ä¾å­˜ã®æ¤œå‡º**
   - ç„¡é™ãƒ«ãƒ¼ãƒ—ã®é˜²æ­¢

4. **Widget-to-Widget Reactivity**
   - åŒä¸€ç”»é¢ä¸Šã§ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€£å‹•

### 4.2 Jellyã¨ã®æ¯”è¼ƒ

| è¦ç´  | Jelly | æœ¬ã‚·ã‚¹ãƒ†ãƒ  |
|------|-------|----------|
| ç²’åº¦ | Item-to-Itemï¼ˆã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å±æ€§é–“ï¼‰ | **Widget-to-Widget**ï¼ˆUIè¦ç´ é–“ï¼‰ |
| ã‚¹ã‚³ãƒ¼ãƒ— | å˜ä¸€ã‚¿ã‚¹ã‚¯å†… | **è¤‡æ•°ã‚¹ãƒ†ãƒƒãƒ—è·¨ã** |
| æ›´æ–°ã‚¿ã‚¤ãƒŸãƒ³ã‚° | ãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ™‚ | ãƒ‡ãƒ¼ã‚¿å¤‰æ›´æ™‚ + **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€£å‹•** |
| Mechanism | Validate / Update | Validate / Updateï¼ˆåŒæ§˜ï¼‰ |
| Relationship | JavaScript / è‡ªç„¶è¨€èª | JavaScript / **çµ„ã¿è¾¼ã¿å¤‰æ›é–¢æ•°** |

### 4.3 ä¾å­˜é–¢ä¿‚ã®æ§‹é€ 

```
Dependency {
  source: string        // ã‚½ãƒ¼ã‚¹ï¼ˆwidget.propertyå½¢å¼ï¼‰
  target: string        // ã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼ˆwidget.propertyå½¢å¼ï¼‰
  mechanism: 'validate' | 'update'
  relationship: {
    type: 'javascript' | 'transform' | 'llm'
    javascript?: string      // JavaScriptã‚¹ãƒ‹ãƒšãƒƒãƒˆ
    transform?: Function     // çµ„ã¿è¾¼ã¿å¤‰æ›é–¢æ•°
    llmPrompt?: string      // LLMå¤‰æ›ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
  }
  updateMode: 'realtime' | 'debounced' | 'on_confirm'
}
```

### 4.4 ä¾å­˜é–¢ä¿‚ã®ä¾‹

#### ä¾‹1: ã‚¹ãƒ†ãƒƒãƒ—é–“ã®ä¾å­˜ï¼ˆå‰æ®µéšâ†’æ¬¡æ®µéšï¼‰

```
EmotionPalette (Step 1)
  â†“ [data dependency]
MatrixPlacement (Step 2)

Dependency:
  source: "step1_emotion.data.emotion"
  target: "step2_matrix.config.xAxisLabel"
  mechanism: "update"
  relationship: {
    type: "transform",
    transform: (emotion) => `${emotion}ã¸ã®å¯¾å‡¦ã®å®Ÿç¾æ€§`
  }
```

#### ä¾‹2: åŒä¸€ç”»é¢ä¸Šã®Reactiveé€£å‹•

```
PrioritySliderGrid
  å·¦å´: MultiAxisSliders
  å³å´: RankingDisplay

Dependency:
  source: "sliders.values"
  target: "ranking.items"
  mechanism: "update"
  relationship: {
    type: "transform",
    transform: (sliderValues) => calculateRanking(sliderValues)
  }
  updateMode: "realtime"
```

### 4.5 ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ¦‚è¦

#### å¾ªç’°ä¾å­˜æ¤œå‡ºï¼ˆDFSï¼‰

```
function detectCycle(graph, source, target):
  visited = new Set()

  function dfs(node):
    if node == source:
      return true  // å¾ªç’°æ¤œå‡º
    if visited.has(node):
      return false

    visited.add(node)
    for each edge in graph.edges[node]:
      if dfs(edge.target):
        return true

    return false

  return dfs(target)
```

#### ãƒˆãƒãƒ­ã‚¸ã‚«ãƒ«ã‚½ãƒ¼ãƒˆï¼ˆæ›´æ–°é †åºï¼‰

```
function topologicalSort(graph):
  inDegree = Map()  // å„ãƒãƒ¼ãƒ‰ã®å…¥æ¬¡æ•°
  queue = []
  result = []

  // å…¥æ¬¡æ•°ã‚’è¨ˆç®—
  for each node in graph.nodes:
    inDegree[node] = 0

  for each edge in graph.edges:
    inDegree[edge.target]++

  // å…¥æ¬¡æ•°0ã®ãƒãƒ¼ãƒ‰ã‚’ã‚­ãƒ¥ãƒ¼ã«è¿½åŠ 
  for each node in graph.nodes:
    if inDegree[node] == 0:
      queue.push(node)

  // BFSã§é †åºæ±ºå®š
  while queue is not empty:
    node = queue.shift()
    result.push(node)

    for each edge in graph.edges[node]:
      inDegree[edge.target]--
      if inDegree[edge.target] == 0:
        queue.push(edge.target)

  return result
```

---

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

### 5.1 Planå…¨ä½“ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
Captureãƒ‡ãƒ¼ã‚¿
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 1 (ç™ºæ•£)      â”‚
â”‚  WidgetA            â”‚
â”‚    â†“ [result]       â”‚
â”‚  WidgetResult A     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ [data binding]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 2 (æ•´ç†)      â”‚
â”‚  WidgetB            â”‚
â”‚    â†“ [result]       â”‚
â”‚  WidgetResult B     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ [data binding]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Step 3 (åæŸ)      â”‚
â”‚  WidgetC            â”‚
â”‚    â†“ [result]       â”‚
â”‚  WidgetResult C     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“ [aggregation]
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SessionResult       â”‚
â”‚ - planSummary       â”‚
â”‚ - structuredData    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
Breakdownãƒ•ã‚§ãƒ¼ã‚º
```

### 5.2 Widgetå†…éƒ¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
WidgetSpec (å…¥åŠ›)
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Widget Controller           â”‚
â”‚                              â”‚
â”‚  initialData                 â”‚
â”‚      â†“                       â”‚
â”‚  getInitialValue()           â”‚
â”‚      â†“                       â”‚
â”‚  Jotai Atom                  â”‚
â”‚      â†“                       â”‚
â”‚  [ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ]              â”‚
â”‚      â†“                       â”‚
â”‚  validateData()              â”‚
â”‚      â†“                       â”‚
â”‚  generateSummary()           â”‚
â”‚  generateStructuredData()    â”‚
â”‚      â†“                       â”‚
â”‚  WidgetResult                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â†“
æ¬¡ã®Widget or çµæœé›†ç´„
```

### 5.3 Reactive Bindingã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
    â†“
Source Widget Stateå¤‰æ›´
    â†“
Jotai Atomæ›´æ–°
    â†“
æ´¾ç”ŸAtomè‡ªå‹•è¨ˆç®—
    â†“
Target Widget Stateæ›´æ–°
    â†“
UIè‡ªå‹•å†æç”»
```

**æ›´æ–°ãƒ¢ãƒ¼ãƒ‰åˆ¥ã®å‹•ä½œ**:

- **realtime**: æ“ä½œæ¯ã«å³åº§ã«æ›´æ–°
- **debounced**: 300mså¾…æ©Ÿå¾Œã«æ›´æ–°
- **on_confirm**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ˜ç¤ºçš„ã«ç¢ºå®šã—ãŸæ™‚ã®ã¿æ›´æ–°

---

## 6. Stateç®¡ç†è¨­è¨ˆ

### 6.1 Jotaiãƒ™ãƒ¼ã‚¹ã®è¨­è¨ˆ

**æ¡ç”¨ç†ç”±**:

1. **Atomicä¾å­˜é–¢ä¿‚ã®è¡¨ç¾**
   - å„Widgetã®Stateã‚’ç‹¬ç«‹ã—ãŸAtomã§ç®¡ç†
   - æ´¾ç”ŸAtomã§ä¾å­˜é–¢ä¿‚ã‚’è¡¨ç¾

2. **è‡ªå‹•æ›´æ–°**
   - ã‚½ãƒ¼ã‚¹Atomã®å¤‰æ›´ãŒè‡ªå‹•çš„ã«æ´¾ç”ŸAtomã«ä¼æ’­

3. **DevToolså¯¾å¿œ**
   - ãƒ‡ãƒãƒƒã‚°ãŒå®¹æ˜“

4. **è»½é‡**
   - ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºãŒå°ã•ã„

### 6.2 Atomæ§‹é€ 

```
widgetAtomsMap: Map<string, Atom>
  â”œâ”€ "widget_emotion_1" â†’ Atom<EmotionData>
  â”œâ”€ "widget_matrix_2" â†’ Atom<MatrixData>
  â””â”€ "widget_slider_3" â†’ Atom<SliderData>

derivedAtomsMap: Map<string, Atom>
  â”œâ”€ "ranking_3" â†’ Atom(get => calculateRanking(get(slider_3)))
  â””â”€ "balance_4" â†’ Atom(get => calculateBalance(...))
```

### 6.3 Stateæ›´æ–°ãƒ•ãƒ­ãƒ¼

```
1. ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œ
   onChange â†’ setAtom(newValue)

2. Atomæ›´æ–°
   widgetAtom.value = newValue

3. ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯
   DependencyGraph.getDependents(widgetId)

4. æ´¾ç”ŸAtomè‡ªå‹•æ›´æ–°
   derivedAtom = atom((get) => transform(get(sourceAtom)))

5. UIå†æç”»
   Reactè‡ªå‹•å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
```

---

## 7. å¤–éƒ¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

### 7.1 LLMã‚µãƒ¼ãƒ“ã‚¹ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
interface LLMService {
  generateUIFlow(input: CaptureData): Promise<UIFlowSpec>
  generateOODM(input: CaptureData): Promise<OODM>
  generateDSL(oodm: OODM, dpg: DependencyGraph): Promise<DSLv3>
}
```

### 7.2 ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰APIã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
interface BackendAPI {
  // ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
  createSession(userId: string): Promise<Session>
  saveWidgetResult(sessionId: string, result: WidgetResult): Promise<void>
  getSessionResults(sessionId: string): Promise<WidgetResult[]>

  // è©•ä¾¡å®Ÿé¨“ç”¨
  saveEvaluationData(data: EvaluationData): Promise<void>
  getUserSurveyResponses(sessionId: string): Promise<SurveyResponse>
}
```

### 7.3 Widgeté–‹ç™ºè€…å‘ã‘ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹

```typescript
// æ–°ã—ã„Widgetã‚’å®Ÿè£…ã™ã‚‹éš›ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
interface CustomWidget extends BaseWidgetController {
  // å¿…é ˆå®Ÿè£…ãƒ¡ã‚½ãƒƒãƒ‰
  getInitialValue(initialData?: any): WidgetData
  getResult(): WidgetResult
  validateData(data: WidgetData): boolean

  // ã‚ªãƒ—ã‚·ãƒ§ãƒ³å®Ÿè£…ãƒ¡ã‚½ãƒƒãƒ‰
  generateSummary(data: WidgetData): string
  generateStructuredData(data: WidgetData): StructuredData
}
```

---

## 8. éæ©Ÿèƒ½è¦æ±‚

### 8.1 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

| é …ç›® | è¦æ±‚å€¤ |
|------|--------|
| Widgetæç”»æ™‚é–“ | 500msä»¥å†… |
| Reactiveæ›´æ–°ãƒ¬ã‚¤ãƒ†ãƒ³ã‚· | 100msä»¥å†… |
| 100å€‹ã®ä¾å­˜é–¢ä¿‚å‡¦ç† | 50msä»¥å†… |
| UIæ“ä½œã®å¿œç­”æ€§ | 60fpsï¼ˆ16.7ms/frameï¼‰ |

### 8.2 ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£

- 1ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚ãŸã‚Šæœ€å¤§20å€‹ã®Widget
- åŒæ™‚å®Ÿè¡Œãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: 10åï¼ˆè©•ä¾¡å®Ÿé¨“æƒ³å®šï¼‰
- ä¾å­˜é–¢ä¿‚ã‚°ãƒ©ãƒ•ã®æœ€å¤§ãƒãƒ¼ãƒ‰æ•°: 100

### 8.3 ä¿¡é ¼æ€§

- Widgetç”ŸæˆæˆåŠŸç‡: 90%ä»¥ä¸Š
- æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ç‡: 10%ä»¥ä¸‹
- å¾ªç’°ä¾å­˜æ¤œå‡ºç‡: 100%

### 8.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£

- JavaScriptã‚¹ãƒ‹ãƒšãƒƒãƒˆå®Ÿè¡Œæ™‚ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–
- XSSå¯¾ç­–ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ã‚µãƒ‹ã‚¿ã‚¤ã‚ºï¼‰
- CSRFå¯¾ç­–

### 8.5 ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£

- ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£: WCAG 2.1 AAæº–æ‹ 
- ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰æ“ä½œå¯¾å¿œ
- ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼å¯¾å¿œ

### 8.6 ä¿å®ˆæ€§

- TypeScriptå‹ã‚«ãƒãƒ¬ãƒƒã‚¸: 100%
- ã‚³ãƒ¼ãƒ‰ã‚«ãƒãƒ¬ãƒƒã‚¸: 70%ä»¥ä¸Š
- ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ç‡: 100%ï¼ˆå…¬é–‹APIï¼‰

---

## 9. ç”¨èªé›†

### DSLå±¤ï¼ˆLLMç”Ÿæˆã•ã‚Œã‚‹æŠ½è±¡ä»•æ§˜ï¼‰

| ç”¨èª | å®šç¾© | ç”Ÿæˆå…ƒ |
|------|------|--------|
| **OODM** | Object-Oriented Data Modelã€‚ã‚¿ã‚¹ã‚¯ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©ã™ã‚‹DSLã€‚ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã€å±æ€§ã€é–¢ä¿‚æ€§ã‚’è¨˜è¿°ã€‚ | LLM |
| **DpG (DSL)** | Dependency Graph Specificationã€‚Widgeté–“ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹DSLã€‚**LLMã®ä¸»è¦ãªå‹•çš„ç”Ÿæˆå¯¾è±¡**ã€‚ | LLM |
| **UISpec (DSL)** | UI Specificationã€‚ç”»é¢å…¨ä½“ã®æ§‹æˆã‚’å®šç¾©ã™ã‚‹DSLã€‚è¤‡æ•°ã®WidgetSpecã€ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ã‚’å«ã‚€ã€‚ | LLM |
| **WidgetSpec (DSL)** | Widget Specificationã€‚**ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetã¸ã®å‚ç…§ã¨è¨­å®š**ã‚’å®šç¾©ã™ã‚‹DSLã€‚UISpecã«å†…åŒ…ã•ã‚Œã‚‹ã€‚Widgetè‡ªä½“ã‚’ç”Ÿæˆã™ã‚‹ã®ã§ã¯ãªãã€ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰é¸å®šã™ã‚‹ã€‚ | LLMï¼ˆé¸å®š+è¨­å®šï¼‰ |
| **ãƒ—ãƒªã‚»ãƒƒãƒˆWidget** | äº‹å‰ã«å®Ÿè£…ã•ã‚ŒãŸ8-12ç¨®é¡ã®Widgetã€‚LLMã¯ã“ã‚Œã‚‰ã‹ã‚‰é¸å®šã™ã‚‹ã€‚Widgetè‡ªä½“ã¯å®Ÿè£…ã‚³ãƒ¼ãƒ‰ã€‚ | å®Ÿè£… |
| **DSL v3** | Domain-Specific Language ãƒãƒ¼ã‚¸ãƒ§ãƒ³3ã€‚æ€è€ƒæ•´ç†ã«ç‰¹åŒ–ã—ãŸUIè¨˜è¿°è¨€èªã€‚TOONè¨˜æ³•ã§è¨˜è¿°ã€‚ | - |

### å®Ÿè£…å±¤ï¼ˆãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼‰

| ç”¨èª | å®šç¾© | ç”Ÿæˆå…ƒ |
|------|------|--------|
| **DSL Parser** | DSLï¼ˆTOONè¨˜æ³•ï¼‰ã‚’TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãƒ‘ãƒ¼ã‚¹ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã€‚ | å®Ÿè£… |
| **UISpecObject** | ãƒ‘ãƒ¼ã‚¹å¾Œã®UISpecã€‚TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚UI RendererãŒä½¿ç”¨ã€‚ | DSL Parser |
| **WidgetSpecObject** | ãƒ‘ãƒ¼ã‚¹å¾Œã®WidgetSpecã€‚TypeScriptã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‚Widget RendererãŒä½¿ç”¨ã€‚ | DSL Parser |
| **Widget** | Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ã—ã¦ã®UIè¦ç´ ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’å—ã‘ä»˜ã‘ã€çµæœã‚’å‡ºåŠ›ã€‚ | å®Ÿè£… |
| **WidgetResult** | Widgetã®å‡ºåŠ›çµæœã€‚summaryã¨dataã‚’å«ã‚€ã€‚å®Ÿè£…ã‚³ãƒ¼ãƒ‰ãŒç”Ÿæˆã€‚ | å®Ÿè£… |
| **BaseWidgetController** | Widgetå…±é€šã®æŠ½è±¡ã‚¯ãƒ©ã‚¹ã€‚çµæœç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’å®Ÿè£…ã€‚ | å®Ÿè£… |
| **DependencyGraph (Class)** | DpGï¼ˆDSLï¼‰ã‚’å®Ÿè¡Œã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚å¾ªç’°ä¾å­˜æ¤œå‡ºã€æ›´æ–°é †åºæ±ºå®šã€‚ | å®Ÿè£… |
| **DependencyExecutor** | ä¾å­˜é–¢ä¿‚ã‚’å®Ÿè¡Œã™ã‚‹ã‚¯ãƒ©ã‚¹ã€‚JavaScriptã‚¹ãƒ‹ãƒšãƒƒãƒˆã‚„å¤‰æ›é–¢æ•°ã‚’å®Ÿè¡Œã€‚ | å®Ÿè£… |
| **Reactive Binding** | Widgeté–“ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€£å‹•ã€‚ã‚½ãƒ¼ã‚¹ã®å¤‰æ›´ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«è‡ªå‹•ä¼æ’­ã€‚DpGã§å®šç¾©ã•ã‚Œã€å®Ÿè£…ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã€‚ | DpGå®šç¾©/å®Ÿè£…å®Ÿè¡Œ |
| **Widget Registry** | ãƒ—ãƒªã‚»ãƒƒãƒˆWidgetï¼ˆ8-12ç¨®ï¼‰ã‚’äº‹å‰ç™»éŒ²ã—ã€componentID â†’ Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’ç®¡ç†ã€‚LLMç”¨ã®Widgetä¸€è¦§ã‚‚æä¾›ã€‚ | å®Ÿè£… |
| **UI Renderer** | UISpecObjectã«åŸºã¥ã„ã¦Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æç”»ã€‚ | å®Ÿè£… |

### ãƒ—ãƒ­ã‚»ã‚¹

| ç”¨èª | å®šç¾© |
|------|------|
| **LLMç”Ÿæˆ** | LLMãŒè‡ªç„¶è¨€èªã‹ã‚‰DSLï¼ˆOODMã€DpGã€UISpecï¼‰ã‚’ç”Ÿæˆã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã€‚**Widgetã¯ç”Ÿæˆã›ãšã€ãƒ—ãƒªã‚»ãƒƒãƒˆã‹ã‚‰é¸å®šã™ã‚‹**ã€‚ |
| **Widgeté¸å®š** | LLMãŒãƒ—ãƒªã‚»ãƒƒãƒˆWidgetä¸€è¦§ï¼ˆ8-12ç¨®ï¼‰ã‹ã‚‰ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ‚©ã¿ã¨ãƒœãƒˆãƒ«ãƒãƒƒã‚¯ã«æœ€é©ãªWidgetã‚’é¸ã¶ãƒ—ãƒ­ã‚»ã‚¹ã€‚OODM/DpGç”Ÿæˆæ™‚ã«å®Ÿæ–½ã€‚ |
| **ãƒ«ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°** | DSLã‚’ãƒ‘ãƒ¼ã‚¹ã—ã€å®šç¾©æ¸ˆã¿ã®ãƒ«ãƒ¼ãƒ«ã«å¾“ã£ã¦Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ç”Ÿæˆã™ã‚‹ãƒ—ãƒ­ã‚»ã‚¹ã€‚LLMã‚’ä½¿ç”¨ã—ãªã„ã€‚ |
| **Widget-to-Widget Reactivity** | åŒä¸€ç”»é¢ä¸Šã®Widgeté–“ã§ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€£å‹•ã€‚**DpGã§å®šç¾©ã•ã‚Œ**ã€Jotai + DependencyExecutorã§å®Ÿè£…ã€‚**LLMã®ä¸»è¦ãªå‹•çš„ç”Ÿæˆå¯¾è±¡**ã€‚ |

---

**ä½œæˆè€…**: TK
**ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼**: ___________
**æ‰¿èªè€…**: ___________
**æ‰¿èªæ—¥**: ___________
